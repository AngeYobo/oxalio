<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr">
<head>
  <meta charset="UTF-8"/>
  <title>Facture Normalisée Électronique - {{FNE_REFERENCE}}</title>
  <style type="text/css">
    * { margin: 0; padding: 0; }
    @page { size: A4; margin: 8mm 10mm 12mm 10mm; }

    body{
      font-family: Arial, Helvetica, sans-serif;
      font-size: 9pt;
      line-height: 1.45;
      color: #000;
    }

    /* HEADER */
    .header-section { width: 100%; margin-bottom: 10px; }
    .header-table { width: 100%; table-layout: fixed; border-collapse: separate; border-spacing: 0; }

    .seller-box{
      border: 1px solid #000;
      border-radius: 8px;
      -webkit-border-radius: 8px;
      padding: 8px 12px;
      vertical-align: top;
      white-space: nowrap;
      line-height: 1.35;
    }
    .seller-box .company-name { font-size: 10pt; font-weight: bold; margin-bottom: 2px; }
    .seller-box .seller-info  { font-size: 8.5pt; line-height: 1.35; }

    .logo-cell{
      text-align: center;
      vertical-align: top;
      padding-left: 0;
      padding-top: 18px;
    }
    .logo-cell img{
      width: 100px;
      height: 100px;
      object-fit: contain;
    }

    /* CONTENU PRINCIPAL */
    .main-table{
      width: 100%;
      table-layout: fixed;
      border-collapse: collapse;
      margin-top: 10px;
    }
    .left-column{ width: 50%; vertical-align: top; padding-right: 16px; }
    .right-column{ width: 50%; vertical-align: top; padding-left: 16px; }

    /* DÉTAILS VENDEUR */
    .vendor-details{
      margin-top: 6px;
      line-height: 1.6;
      white-space: nowrap;
    }
    .vendor-details .label{
      font-weight: bold;
      display: inline-block;
      min-width: 155px;
    }

    /* ENCADRÉ SÉCURISATION */
    .security-box{
      border: none;
      padding: 0;
      margin-bottom: 8px;
    }
    .invoice-ref-title{
      font-size: 9pt;
      font-weight: normal;
      text-align: right;
      margin-bottom: 8px;
    }

    .qr-sticker-table{
      margin: 0;
      margin-left: auto;
      border-collapse: collapse;
    }
    .qr-sticker-table td{ vertical-align: top; }

    .qr-code-cell, .sticker-cell{ padding: 0; }
    .qr-code-cell{ padding-right: 6px; }

    .qr-code-cell img{ width: 90px; height: 90px; }
    .sticker-cell img{ width: 100px; height: 100px; object-fit: contain; }

    /* CLIENT */
    .client-section{
      margin-top: 6px;
      padding-top: 0;
      border-top: none;
    }
    .client-title{
      font-size: 9pt;
      font-weight: bold;
      margin: 4px 0 4px 0;
    }
    .client-details{
      font-size: 9pt;
      line-height: 1.45;
    }

    /* MESSAGE COMMERCIAL */
    .message-line{
      font-size: 9pt;
      color: #000;
      margin-top: 14px;
      white-space: nowrap;
    }

    /* TABLEAU PRODUITS */
    .products-table{
      width: 100%;
      border-collapse: collapse;
      font-size: 7.5pt;
      margin-top: 12px;
    }
    .products-table th{
      background-color: transparent;
      border: 1px solid #000;
      padding: 4px 3px;
      text-align: center;
      font-weight: bold;
      font-size: 7pt;
    }
    .products-table td{
      border: 1px solid #000;
      padding: 4px 3px;
      text-align: center;
      font-size: 7.5pt;
    }
    .products-table td.left{ text-align: left; padding-left: 5px; }
    .products-table td.right{ text-align: right; padding-right: 5px; }

    /* TOTAUX */
    .totals-table{
      float: right;
      width: 45%;
      border-collapse: collapse;
      font-size: 7.5pt;
      margin-top: 2px;
    }
    .totals-table td{ border: 1px solid #000; padding: 4px 6px; }
    .totals-table .label-cell{ text-align: center; width: 60%; }
    .totals-table .value-cell{ text-align: right; width: 40%; }
    .totals-table .total-row td{
      font-weight: bold;
      font-size: 8pt;
      background-color: transparent;
    }
    .clear{ clear: both; }

    /* RÉSUMÉ TVA */
    .summary-section{
      margin-top: 6px;
      clear: both;
    }
    .summary-title{
      font-size: 8pt;
      font-weight: bold;
      margin-bottom: 5px;
      text-transform: uppercase;
    }
    .summary-table{
      width: 100%;
      border-collapse: collapse;
      font-size: 7.5pt;
    }
    .summary-table th{
      background-color: transparent;
      border: 1px solid #000;
      padding: 4px 5px;
      text-align: center;
      font-weight: bold;
      font-size: 7pt;
    }
    .summary-table td{
      border: 1px solid #000;
      padding: 4px 5px;
      text-align: center;
    }
    .summary-table td.left{ text-align: left; }
    .summary-table td.right{ text-align: right; }
  </style>
</head>

<body>
  <!-- HEADER : Encadré émetteur + Logo -->
  <div class="header-section">
    <table class="header-table" style="width:100%;">
      <tr>
        <td style="width:45%; vertical-align:top;">
          <div class="seller-box">
            <div class="company-name">{{SELLER_COMPANY_NAME}}</div>
            <div class="seller-info">
              NCC : {{SELLER_NCC}}<br/>
              Régime d'imposition : {{SELLER_REGIME}}<br/>
              Centre des impôts : {{SELLER_TAX_CENTER}}
            </div>
          </div>
        </td>

        <td class="logo-cell" style="width:10%; text-align:center;">
          <img src="{{SELLER_LOGO_BASE64}}" alt="Logo"/>
        </td>

        <td style="width:45%;"></td>
      </tr>
    </table>
  </div>

  <!-- CONTENU PRINCIPAL : 2 colonnes -->
  <table class="main-table" style="width:100%;">
    <tr>
      <!-- COLONNE GAUCHE -->
      <td class="left-column">
        <div class="vendor-details">
          <span class="label">RCCM :</span> {{SELLER_RCCM}}<br/>
          <span class="label">Références bancaires :</span> {{SELLER_BANK_REF}}<br/>
          <span class="label">Établissement :</span> {{SELLER_ESTABLISHMENT}}<br/>
          <span class="label">Adresse :</span> {{SELLER_ADDRESS}}<br/>
          <span class="label">N° Tel :</span> {{SELLER_PHONE}}<br/>
          <span class="label">Mail :</span> {{SELLER_EMAIL}}<br/>
          <span class="label">Nom du vendeur :</span> {{SELLER_NAME}}<br/>
          <span class="label">Nom de PDV :</span> {{SELLER_POS_NAME}}<br/>
          <span class="label">Date et heure :</span> {{INVOICE_DATE_TIME}}<br/>
          <span class="label">Mode de paiement :</span> {{PAYMENT_MODE}}
        </div>
        <div class="message-line">{{COMMERCIAL_MESSAGE}}</div>
      </td>

      <!-- COLONNE DROITE -->
      <td class="right-column">
        <div class="security-box">
          <div class="invoice-ref-title">Facture de vente N° {{FNE_REFERENCE}}</div>
          <table class="qr-sticker-table">
            <tr>
              <td class="qr-code-cell"><img src="{{QR_CODE_BASE64}}" alt="QR Code"/></td>
              <td class="sticker-cell"><img src="{{FNE_STICKER_BASE64}}" alt="FNE"/></td>
            </tr>
          </table>

          <div class="client-section">
            <div class="client-title">Client</div>
            <div class="client-details">
              <span class="label">Nom :</span> {{BUYER_NAME}}<br/>
              <span class="label">Adresse :</span> {{BUYER_ADDRESS}}<br/>
              <span class="label">NCC :</span> {{BUYER_NCC}}
            </div>
          </div>
        </div>
      </td>
    </tr>
  </table>

  <!-- TABLEAU DES PRODUITS -->
  <table class="products-table">
    <thead>
      <tr>
        <th style="width:12%;">Réf</th>
        <th style="width:28%;">Désignation</th>
        <th style="width:10%;">P.U HT</th>
        <th style="width:6%;">Qté</th>
        <th style="width:7%;">Unité</th>
        <th style="width:12%;">Taxes (%)</th>
        <th style="width:10%;">Rem. (%)</th>
        <th style="width:15%;">Montant HT</th>
      </tr>
    </thead>
    <tbody>
      {{INVOICE_LINES}}
    </tbody>
  </table>

  <!-- TOTAUX -->
  <div style="width:100%; margin-top:6px;">
    <table class="totals-table">
      <tr><td class="label-cell">TOTAL HT</td><td class="value-cell">{{TOTAL_HT}}</td></tr>
      <tr><td class="label-cell">TVA</td><td class="value-cell">{{TOTAL_TVA}}</td></tr>
      <tr><td class="label-cell">TOTAL TTC</td><td class="value-cell">{{TOTAL_TTC}}</td></tr>
      <tr><td class="label-cell">AUTRES TAXES</td><td class="value-cell">{{OTHER_TAXES}}</td></tr>
      <tr><td class="label-cell">TIMBRE DE QUITTANCE</td><td class="value-cell">{{STAMP_TAX}}</td></tr>
      <tr class="total-row"><td class="label-cell">TOTAL A PAYER</td><td class="value-cell">{{TOTAL_TO_PAY}}</td></tr>
    </table>
    <div class="clear"></div>
  </div>

  <!-- RÉSUMÉ DE LA FACTURE -->
  <div class="summary-section">
    <div class="summary-title">RESUME DE LA FACTURE</div>
    <table class="summary-table">
      <thead>
        <tr>
          <th style="width:50%;">CATEGORIE</th>
          <th style="width:20%;">SOUS-TOTAL</th>
          <th style="width:15%;">TAUX (%)</th>
          <th style="width:15%;">TOTAL TAXES</th>
        </tr>
      </thead>
      <tbody>
        {{TAX_SUMMARY_LINES}}
      </tbody>
    </table>
  </div>
</body>
</html>
